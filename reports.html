<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<meta http-equiv="Content-Language" content="en">
<meta name="google" content="notranslate">

<title>My Refund â€” Reports</title>

<style>
:root{
  --g0:#094B35;
  --g2:#ECFDF5;
  --text:#111827;
  --muted:#6b7280;
  --border:#e5e7eb;
  --radius:16px;
  --shadow:0 14px 40px rgba(0,0,0,.18);
}

*{box-sizing:border-box}

body{
  margin:0;
  font-family:"Okta Neue", system-ui, -apple-system, Segoe UI, Roboto, Arial, sans-serif;
  color:var(--text);
}

/* ===== PAGE BACKGROUND ===== */
.page{
  min-height:100vh;
  background:url("My Refund-Hero Images-02 (1).jpg") center / cover no-repeat;
}

/* ===== HEADER ===== */
.header{
  background:var(--g0);
  color:#fff;
  padding:14px 24px;
}

.header-inner{
  max-width:1200px;
  margin:0 auto;
  display:flex;
  justify-content:space-between;
  align-items:center;
}

.brand{
  display:flex;
  align-items:center;
  gap:14px;
}

.brand img{height:26px}

.brand-text strong{
  font-size:15px;
  font-weight:900;
}

.brand-text span{
  font-size:12px;
  opacity:.9;
  font-weight:700;
}

.menu{
  display:flex;
  gap:10px;
}

.menu button{
  border-radius:999px;
  padding:8px 16px;
  font-weight:900;
  font-size:13px;
  border:1px solid #fff;
  background:#fff;
  color:var(--g0);
  cursor:pointer;
}

/* ===== CONTENT WRAP ===== */
.wrap{
  max-width:1200px;
  margin:0 auto;
  padding:28px 24px 60px;
}

/* ===== FILTER BAR PANEL ===== */
.panel{
  background:rgba(255,255,255,.95);
  border-radius:var(--radius);
  box-shadow:var(--shadow);
  padding:22px;
  margin-bottom:24px;
}

.panel h3{
  margin:0 0 18px;
  font-size:16px;
  font-weight:900;
  color:var(--g0);
}

/* ===== FILTER GRID ===== */
.filter-grid{
  display:grid;
  grid-template-columns:repeat(auto-fit,minmax(160px,1fr));
  gap:16px;
  align-items:end;
}

label{
  display:block;
  font-size:12px;
  font-weight:900;
  margin-bottom:6px;
}

input, select{
  width:100%;
  padding:10px;
  border-radius:10px;
  border:1px solid var(--border);
  font-weight:700;
}

button.primary{
  padding:12px 18px;
  border-radius:12px;
  border:none;
  background:var(--g0);
  color:#fff;
  font-weight:900;
  cursor:pointer;
}

button.secondary{
  padding:12px 18px;
  border-radius:12px;
  border:1px solid var(--g0);
  background:#fff;
  color:var(--g0);
  font-weight:900;
  cursor:pointer;
}

/* ===== TABLE ===== */
table{
  width:100%;
  border-collapse:collapse;
}

th,td{
  border-bottom:1px solid var(--border);
  padding:10px 8px;
  font-size:13px;
}

th{
  color:var(--muted);
  font-weight:900;
  text-align:left;
}

.right{text-align:right}

.empty{
  background:var(--g2);
  border:1px dashed rgba(3,149,63,.35);
  border-radius:14px;
  padding:12px;
  color:var(--g0);
  font-weight:900;
}
</style>
</head>

<body>
<div class="page">

<!-- HEADER -->
<div class="header">
  <div class="header-inner">
    <div class="brand">
      <img src="logo.png">
      <div class="brand-text">
        <strong>Reports</strong>
        <span>Team totals & productivity</span>
      </div>
    </div>
    <div class="menu">
      <button onclick="goHome()">Home</button>
      <button onclick="goAdmin()">Admin</button>
    </div>
  </div>
</div>

<div class="wrap">

  <!-- FILTERS -->
  <div class="panel">
    <h3>Filters</h3>

    <div class="filter-grid">
      <div>
        <label>Start date</label>
        <input type="date" id="startDate">
      </div>

      <div>
        <label>End date</label>
        <input type="date" id="endDate">
      </div>

      <div>
        <label>Division</label>
        <select id="divisionFilter">
          <option value="All">All</option>
          <option value="CSR">CSR</option>
          <option value="Processing">Processing</option>
        </select>
      </div>

      <div>
        <label>Work type</label>
        <select id="workFilter"></select>
      </div>

      <div>
        <button class="secondary" onclick="runReport()">Run report</button>
      </div>

      <div>
        <button class="primary" onclick="downloadPdf()">Download PDF</button>
      </div>
    </div>
  </div>

  <!-- TEAM TOTALS -->
  <div class="panel">
    <h3>Team totals</h3>
    <div id="teamTotalsArea" class="empty">No data yet</div>
  </div>

  <!-- PRODUCTIVITY -->
  <div class="panel">
    <h3>Individual productivity</h3>
    <div id="productivityArea" class="empty">No data yet</div>
  </div>

</div>
</div>

<script>
const WEB_APP_URL="https://script.google.com/macros/s/AKfycbxrteoDa30Q_uz2-O4j_HE_agEpsCl7LlnPTghyWktDp2VXykkSHjoAqeZ4Jiz3nnYJ/exec";
const TZ="Pacific/Auckland";

const CSR_WORK=["A2A","Unverified","Emails","INC/C Calling","Question Calling","A2A Calling"];
const PROCESSING_WORK=["Filing","Linking","Linked Review","Inbox","Existing Review","Processing Review","Miscellaneous"];

const startEl=document.getElementById("startDate");
const endEl=document.getElementById("endDate");
const divisionFilter=document.getElementById("divisionFilter");
const workFilter=document.getElementById("workFilter");

function nzTodayISO(){
  return new Date().toLocaleDateString("en-CA",{timeZone:TZ});
}

function populateWorkFilter(){
  const division=divisionFilter.value;
  workFilter.innerHTML=`<option value="All">All Work</option>`;
  let list=[];
  if(division==="CSR") list=CSR_WORK;
  else if(division==="Processing") list=PROCESSING_WORK;
  else list=[...CSR_WORK,...PROCESSING_WORK];

  list.forEach(w=>{
    const opt=document.createElement("option");
    opt.value=w;
    opt.textContent=w;
    workFilter.appendChild(opt);
  });
}

function buildEmptyMessage(){
  const division=divisionFilter.value;
  const work=workFilter.value;
  const start=startEl.value;
  const end=endEl.value;
  let divText=division==="All"?"work":division+" work";
  let workText=work==="All"?"":` of type '${work}'`;
  return `No ${divText}${workText} found for ${start} to ${end}.`;
}

async function runReport(){
  document.getElementById("teamTotalsArea").innerHTML=`<div class="empty">${buildEmptyMessage()}</div>`;
  document.getElementById("productivityArea").innerHTML=`<div class="empty">${buildEmptyMessage()}</div>`;
}

function downloadPdf(){
  const start=startEl.value;
  const end=endEl.value;
  const division=divisionFilter.value;
  const work=workFilter.value;
  const url=`${WEB_APP_URL}?action=pdf&start=${start}&end=${end}&division=${division}&work=${work}`;
  window.open(url,"_blank");
}

function goHome(){window.location.href="index.html";}
function goAdmin(){window.location.href="admin.html";}

(function init(){
  const today=nzTodayISO();
  startEl.value=today;
  endEl.value=today;
  populateWorkFilter();
  divisionFilter.addEventListener("change",populateWorkFilter);
})();
</script>
</body>
</html>
