<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width,initial-scale=1">

<title>My Refund — Processing Workspace</title>

<style>
:root{
  --g0:#094B35;
  --g2:#ECFDF5;
  --text:#111827;
  --muted:#6b7280;
  --border:#e5e7eb;
  --radius:16px;
  --shadow:0 12px 32px rgba(0,0,0,.14);
}
*{box-sizing:border-box}
body{
  margin:0;
  font-family:"Okta Neue", system-ui, -apple-system, Segoe UI, Roboto, Arial, sans-serif;
  color:var(--text);
}
.page{
  min-height:100vh;
  background:url("My Refund-Hero Images-02 (1).jpg") center / cover no-repeat;
  transition:.2s ease;
}
.page.submitting{
  opacity:.7;
}

/* HEADER */
.header{
  background:var(--g0);
  color:#fff;
  padding:14px 24px;
}
.header-inner{
  max-width:1300px;
  margin:0 auto;
  display:flex;
  justify-content:space-between;
  align-items:center;
}
.brand{
  display:flex;
  align-items:center;
  gap:14px;
}
.brand img{height:26px}
.brand-text strong{
  font-size:15px;
  font-weight:900;
}
.brand-text span{
  font-size:12px;
  opacity:.9;
  font-weight:700;
}
.header-right{
  display:flex;
  align-items:center;
  gap:14px;
}
.dashboard-btn{
  border-radius:999px;
  padding:8px 16px;
  font-weight:900;
  font-size:13px;
  border:1px solid #fff;
  background:transparent;
  color:#fff;
  cursor:pointer;
}
.clock{font-weight:900;font-size:14px}

/* BUTTON LOADING */
.submit button{
  width:100%;
  border-radius:14px;
  padding:14px;
  font-weight:900;
  font-size:15px;
  border:none;
  background:var(--g0);
  color:#fff;
  cursor:pointer;
  position:relative;
}
.submit button.loading{
  pointer-events:none;
}
.submit button.loading::after{
  content:"";
  position:absolute;
  right:18px;
  top:50%;
  width:16px;
  height:16px;
  margin-top:-8px;
  border:2px solid rgba(255,255,255,.5);
  border-top:2px solid #fff;
  border-radius:50%;
  animation:spin .8s linear infinite;
}
@keyframes spin{
  from{transform:rotate(0deg)}
  to{transform:rotate(360deg)}
}
</style>
</head>

<body>
<div class="page">

<div class="header">
  <div class="header-inner">
    <div class="brand">
      <img src="logo.png">
      <div class="brand-text">
        <strong id="staffNameLabel">Processing</strong>
        <span>Daily Work Logger</span>
      </div>
    </div>
    <div class="header-right">
      <button class="dashboard-btn" onclick="goHome()">← Dashboard</button>
      <div class="clock" id="clock"></div>
    </div>
  </div>
</div>

<!-- (Your existing body content remains unchanged until script) -->

<script>
document.addEventListener("DOMContentLoaded", function(){

const WEB_APP_URL = "YOUR_WEB_APP_URL";
const TZ="Pacific/Auckland";
const name=localStorage.getItem("currentStaff")||"Processing";
const todayISO=new Date().toLocaleDateString("en-CA",{timeZone:TZ});

window.goHome=function(){window.location.href="index.html";};

/* UPDATED FEE CALCULATION */

function calculateFee(type,R,receiptAssist,backYear){

if(type==="ITA"){
let f=(R*0.11+34.5)*1.15;
if(R<39.68)return R;
return f>345?345:f;
}

if(type==="IR3"){

if(backYear){
let f=(R*0.11)*1.15; // removed $29.50+GST
if(R< (R*0.11*1.15)) return R;
return f>402.5?402.5:f;
}

let f=(R*0.11+49.5)*1.15;
if(R<56.93)return R;
return f>402.5?402.5:f;
}

if(type==="REB"){
let tier=R<500?45.99:(R<2000?68.99:91.99);
if(receiptAssist) tier+=6.89;
return R<tier?R:tier;
}

return 0;
}

/* UPDATED SUBMIT UX */

window.submitDay=async function(){

if(!confirm("Submit day? This cannot be edited."))return;

const btn=document.querySelector(".submit button");
btn.classList.add("loading");
btn.textContent="Submitting...";
document.querySelector(".page").classList.add("submitting");

try{
await fetch(WEB_APP_URL,{method:"POST",mode:"no-cors",body:new FormData()});
btn.textContent="Submitted ✓";
setTimeout(()=>{window.location.href="index.html";},2000);
}catch(err){
btn.classList.remove("loading");
btn.textContent="Submit & Finish Day";
document.querySelector(".page").classList.remove("submitting");
alert("Network error.");
}
};

/* CLOCK */
function tick(){
clock.textContent=new Date().toLocaleTimeString("en-NZ",{hour:"numeric",minute:"2-digit",second:"2-digit"});
}
tick();setInterval(tick,1000);

});
</script>

</body>
</html>
