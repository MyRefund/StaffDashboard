<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<meta http-equiv="Content-Language" content="en">
<meta name="google" content="notranslate">
<title>My Refund — Processing Workspace</title>

<style>
:root{
  --g0:#094B35;
  --g2:#ECFDF5;
  --text:#111827;
  --muted:#6b7280;
  --border:#e5e7eb;
  --radius:16px;
  --shadow:0 12px 32px rgba(0,0,0,.14);
}
*{box-sizing:border-box}
body{
  margin:0;
  font-family:"Okta Neue", system-ui, -apple-system, Segoe UI, Roboto, Arial, sans-serif;
  color:var(--text);
}
.page{
  min-height:100vh;
  background:url("My Refund-Hero Images-02 (1).jpg") center / cover no-repeat;
  transition:.2s ease;
}
.page.submitting{ opacity:.7; }

/* HEADER */
.header{
  background:var(--g0);
  color:#fff;
  padding:14px 24px;
}
.header-inner{
  max-width:1300px;
  margin:0 auto;
  display:flex;
  justify-content:space-between;
  align-items:center;
}
.brand{
  display:flex;
  align-items:center;
  gap:14px;
}
.brand img{height:26px}
.brand-text strong{font-size:15px;font-weight:900}
.brand-text span{font-size:12px;opacity:.9;font-weight:700}
.header-right{
  display:flex;
  align-items:center;
  gap:12px;
}
.dashboard-btn{
  border-radius:999px;
  padding:8px 16px;
  font-weight:900;
  font-size:13px;
  border:1px solid #fff;
  background:transparent;
  color:#fff;
  cursor:pointer;
}
.clock{font-weight:900;font-size:14px}

.top-update{
  border-radius:999px;
  padding:8px 16px;
  font-weight:900;
  font-size:13px;
  border:none;
  background:#fff;
  color:var(--g0);
  cursor:pointer;
}

/* TABS */
.tabs{
  background:#fff;
  padding:12px 24px;
  display:flex;
  gap:10px;
  border-bottom:1px solid var(--border);
}
.tab{
  border-radius:999px;
  padding:8px 16px;
  font-weight:900;
  font-size:13px;
  border:1px solid var(--g0);
  background:#fff;
  color:var(--g0);
  cursor:pointer;
}
.tab.active{background:var(--g0);color:#fff;}

.wrap{
  max-width:1300px;
  margin:0 auto;
  padding:36px 24px 60px;
}

.layout{
  display:grid;
  grid-template-columns:1fr 260px;
  gap:24px;
}
.panel{
  background:rgba(255,255,255,.96);
  border-radius:var(--radius);
  box-shadow:var(--shadow);
  padding:20px;
  margin-bottom:20px;
}
.panel h3{
  margin:0 0 14px 0;
  font-size:18px;
  font-weight:900;
  color:var(--g0);
}

.grid{
  display:grid;
  grid-template-columns:repeat(auto-fit,minmax(180px,1fr));
  gap:14px;
}
.item{
  background:#fff;
  border:1px solid var(--border);
  border-radius:14px;
  padding:14px;
}
.controls{
  display:flex;
  align-items:center;
  gap:6px;
}
.controls button{
  width:32px;height:32px;
  border-radius:8px;
  border:1px solid var(--border);
  background:#fff;
  font-weight:900;
  cursor:pointer;
}
.controls input{
  width:56px;
  text-align:center;
  border:1px solid var(--border);
  border-radius:8px;
  padding:6px;
  font-weight:900;
}

.button-grid{
  display:grid;
  grid-template-columns:repeat(auto-fit,minmax(120px,1fr));
  gap:12px;
  margin-bottom:16px;
}
.type-btn{
  border-radius:12px;
  padding:10px;
  font-weight:900;
  border:2px solid var(--g0);
  background:#fff;
  color:var(--g0);
  cursor:pointer;
}
.type-btn.active{background:var(--g0);color:#fff;}

input[type="text"]{
  padding:10px;
  border-radius:10px;
  border:1px solid var(--border);
  font-weight:700;
  width:100%;
}

.inline-check{
  display:flex;
  align-items:center;
  gap:10px;
  margin-top:10px;
  padding:10px 12px;
  border:1px solid var(--border);
  border-radius:12px;
  background:#fff;
  font-weight:900;
  color:var(--muted);
  font-size:13px;
}

.add-btn{
  margin-top:10px;
  padding:10px 16px;
  border:none;
  border-radius:12px;
  background:var(--g0);
  color:#fff;
  font-weight:900;
  cursor:pointer;
}

.total-box{
  background:var(--g2);
  border-radius:12px;
  padding:14px;
  font-weight:900;
  font-size:18px;
  text-align:right;
}

.submit button{
  width:100%;
  border-radius:14px;
  padding:14px;
  font-weight:900;
  font-size:15px;
  border:none;
  background:var(--g0);
  color:#fff;
  cursor:pointer;
}
</style>
</head>

<body>
<div class="page">

<div class="header">
  <div class="header-inner">
    <div class="brand">
      <img src="logo.png">
      <div class="brand-text">
        <strong id="staffNameLabel">Processing</strong>
        <span>Daily Work Logger</span>
      </div>
    </div>
    <div class="header-right">
      <button class="top-update" onclick="updateDay()">Update</button>
      <button class="dashboard-btn" onclick="goHome()">← Dashboard</button>
      <div class="clock" id="clock"></div>
    </div>
  </div>
</div>

<div class="tabs">
  <button class="tab active" onclick="switchTab('work', this)">Work Log</button>
  <button class="tab" onclick="switchTab('resources', this)">Resources</button>
</div>

<div class="wrap">

<div id="workTab">

<div style="margin-bottom:28px;">
  <div style="font-size:24px;font-weight:900;color:var(--g0);">
    Hello, <span id="helloName"></span>
  </div>
</div>

<div class="layout">

<div>

<div class="panel">
<h3>Return Fee Logging</h3>

<div class="button-grid">
<button class="type-btn" onclick="selectType(event,'ITA')">ITA</button>
<button class="type-btn" onclick="selectType(event,'IR3')">IR3</button>
<button class="type-btn" onclick="selectType(event,'REB')">REB</button>
<button class="type-btn" onclick="autoAdd('AA')">AA</button>
<button class="type-btn" onclick="autoAdd('R3P')">R3P</button>
<button class="type-btn" onclick="autoAdd('OP')">OP</button>
</div>

<div id="inputSection" class="hidden">
<input type="text" id="amountInput" placeholder="Refund Amount">

<label id="backYearLabel" class="hidden inline-check">
<input type="checkbox" id="backYear">
<span>Back Year</span>
</label>

<label id="receiptLabel" class="hidden inline-check">
<input type="checkbox" id="receiptAssist">
<span>Receipt Assistance</span>
</label>

<button class="add-btn" onclick="addEntry()">Add</button>
</div>

<div class="total-box">
Total Fees Today: $<span id="totalFees">0.00</span>
</div>

<div class="submit">
<button onclick="submitDay()">Submit & Finish Day</button>
</div>

</div>

</div>

<div>
<div class="panel">
<h3>Quick Contacts</h3>
<strong>My Refund</strong><br>
0800 80 89 89<br>
info@myrefund.co.nz
</div>
</div>

</div>
</div>

</div>

<script>
document.addEventListener("DOMContentLoaded",function(){

const WEB_APP_URL="YOUR_WEB_APP_URL";
const name=localStorage.getItem("currentStaff")||"Processing";

document.getElementById("staffNameLabel").textContent=name;
document.getElementById("helloName").textContent=name;

setInterval(()=>{clock.textContent=new Date().toLocaleTimeString("en-NZ")},1000);

let entries=[];
let currentType=null;

window.goHome=function(){window.location.href="index.html"};

function clean(v){return parseFloat(String(v||"").replace(/[$, ]/g,''))||0}

function calculateFee(type,R,receiptAssist,backYear){

if(type==="ITA"){
if(R<39.68)return R;
let base=(R*0.11)+5;
if(!backYear)base+=29.5;
let fee=base*1.15;
return fee>345?345:fee;
}

if(type==="IR3"){
if(backYear){
if(R<23)return R;
let base=(R*0.11)+20;
let fee=base*1.15;
return fee>402.5?402.5:fee;
}
if(R<56.93)return R;
let base=(R*0.11)+20+29.5;
let fee=base*1.15;
return fee>402.5?402.5:fee;
}

if(type==="REB"){
let tier=R<500?45.99:(R<2000?68.99:91.99);
if(receiptAssist)tier+=6.89;
return R<tier?R:tier;
}

return 0;
}

window.selectType=function(e,type){
currentType=type;
document.querySelectorAll(".type-btn").forEach(b=>b.classList.remove("active"));
e.target.classList.add("active");
inputSection.classList.remove("hidden");

backYearLabel.classList.add("hidden");
receiptLabel.classList.add("hidden");
backYear.checked=false;
receiptAssist.checked=false;

if(type==="ITA"||type==="IR3"){
backYearLabel.classList.remove("hidden");
}

if(type==="REB"){
receiptLabel.classList.remove("hidden");
}
};

amountInput.addEventListener("keydown",function(e){
if(e.key==="Enter"){
e.preventDefault();
addEntry();
}
});

window.autoAdd=function(type){
entries.push({type:type,amount:null,fee:39.10});
updateTotal();
};

window.addEntry=function(){
if(!currentType)return;
let R=clean(amountInput.value);
if(!R)return;
let fee=calculateFee(currentType,R,receiptAssist.checked,backYear.checked);
entries.push({type:currentType,amount:R,fee:fee});
amountInput.value="";
updateTotal();
};

function updateTotal(){
let total=entries.reduce((s,e)=>s+e.fee,0);
totalFees.textContent=total.toFixed(2);
}

window.updateDay=function(){
let fd=new URLSearchParams();
fd.append("action","updateProcessing");
fd.append("staff",name);
fd.append("entries",JSON.stringify(entries));
fetch(WEB_APP_URL,{method:"POST",mode:"no-cors",body:fd});
};

window.submitDay=function(){
let fd=new URLSearchParams();
fd.append("action","submitProcessing");
fd.append("staff",name);
fd.append("entries",JSON.stringify(entries));
fetch(WEB_APP_URL,{method:"POST",mode:"no-cors",body:fd});
setTimeout(()=>window.location.href="index.html",2000);
};

});
</script>

</body>
</html>
